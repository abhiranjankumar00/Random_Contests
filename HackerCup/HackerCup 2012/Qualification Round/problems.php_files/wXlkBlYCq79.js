/*1327104327,176820405*/

if (window.CavalryLogger) { CavalryLogger.start_js(["W9aOa"]); }

window.HackerCup={complete:function(a){DOM.setContent($('hackercup_submit_controls'),a);CSS.removeClass('hackercup_submit','async_saving');Arbiter.inform(HackerCupConst.SUCCESSFUL_UPLOAD,{});},incomplete:function(a){DOM.setContent($('hackercup_submit_message'),a);CSS.removeClass('hackercup_submit','async_saving');}};
function SocialPollController(a,b,c){this.poll_id=a;this.is_answered=b;this.is_social=c;this._init();}copy_properties(SocialPollController,{POLL_STATE_INITIAL:0,POLL_STATE_ANSWERED:1,MAX_RESULT_WIDTH:300});copy_properties(SocialPollController.prototype,{_init:function(){if(!this.is_answered){var a=DOM.scry($('choices_'+this.poll_id),'input[type="radio"]');if(a)for(var c=0;c<a.length;c++){var d=a[c];Event.listen(d,'click',this._vote.bind(this,d));}}if(this.is_social){var e=DOM.scry($('who_voted_'+this.poll_id),'a.show_friend_votes');if(e){show_friend_link=e[0];Event.listen(show_friend_link,'click',this._showFriends.bind(this));}}var b=ge('delete_'+this.poll_id);if(b){var f=DOM.find(b,'a.x_to_hide');Event.listen(f,'click',this.deleteSocialPoll.bind(this));}},_showFriends:function(){var b=DOM.scry($('answers_'+this.poll_id),'div.friends');for(var c=0;c<b.length;c++){var a=b[c];if(a.childNodes.length>0)if(!CSS.shown(a)){animation(a).show().from('height',0).to('height','auto').duration(200).go();}else animation(a).to('height',0).duration(200).hide().go();}return false;},_vote:function(h){var j=h.value;var b=$('choices_'+this.poll_id);var g=DOM.scry(b,'input.inputradio');var a=0;var i=Vector2.getElementPosition(h);var c=Vector2.getElementPosition(b);var f=new Vector2(a,i.y-c.y,'document');for(var d=0;d<g.length;d++)g[d].disabled=true;var e=DOM.find(b,'img.submit_progress');f.setElementPosition(e);CSS.setStyle(h,'visibility','hidden');CSS.removeClass(e,'hidden');new AsyncRequest().setURI("/ajax/polls/social_poll_vote.php").setMethod('POST').setData({poll_id:this.poll_id,vote:j}).setHandler(this.socialPollShowResults.bind(this)).send();return false;},socialPollShowResults:function(b){var a=$('choices_'+this.poll_id);var c=DOM.find(a,'img.submit_progress');CSS.addClass(c,'hidden');DOM.replace($('choices_'+this.poll_id),HTML(b.getPayload()));this.animatePollResults();show($('who_voted_'+this.poll_id));},animatePollResults:function(){var c=DOM.scry($('answers_'+this.poll_id),'div.result_bar');for(var b=0;b<c.length;b++){var a=c[b];var d=a.offsetWidth;CSS.setStyle(a,'width','0px');animation(a).from('width',0).to('width',d).duration(500).ease(animation.ease.both).go();}},deleteSocialPoll:function(){new Dialog().setTitle("Delete Poll").setBody("Are you sure you want to delete this poll? This action cannot be undone.").setButtons([Dialog.OK,Dialog.CANCEL]).setHandler(this._deleteSocialPoll.bind(this)).show();},_deleteSocialPoll:function(){var b=DOM.find($('pollrow_'+this.poll_id),'div.polltitle h3');DOM.setContent(b,"Deleting Poll...");hide(ge('answers_'+this.poll_id));hide(ge('choices_'+this.poll_id));hide(ge('who_voted_'+this.poll_id));hide(ge('vote_count_'+this.poll_id));var c=DOM.find($('delete_'+this.poll_id),'a.x_to_hide');CSS.setStyle(c,'background','url(/images/loaders/indicator_blue_small.gif?8:111099)'+' no-repeat scroll center');CSS.setStyle(c,'width','16px');var a=new AsyncRequest().setURI('/ajax/polls/social_poll_delete.php').setMethod('POST').setData({poll_id:this.poll_id}).setHandler(this._deleteSocialPollAjaxHandler.bind(this)).send();},_deleteSocialPollAjaxHandler:function(b){var a=$('pollrow_'+this.poll_id);DOM.empty(a);hide(a);return false;}});